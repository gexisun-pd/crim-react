<!DOCTYPE html>
<html>
<head>
    <script src="https://www.verovio.org/javascript/develop/verovio-toolkit-wasm.js"></script>
    <title>Verovio SVG Structure Debug</title>
</head>
<body>
    <div id="output"></div>
    <script>
        verovio.module.onRuntimeInitialized = function() {
            const vrvToolkit = new verovio.toolkit();
            
            vrvToolkit.setOptions({
                adjustPageHeight: true,
                pageHeight: 2970,
                pageWidth: 2100,
                scale: 40,
                font: 'Leipzig'
            });

            // Simple test MusicXML
            const testXML = `<?xml version="1.0" encoding="UTF-8"?>
<score-partwise version="3.1">
  <part-list>
    <score-part id="P1">
      <part-name>Voice</part-name>
    </score-part>
  </part-list>
  <part id="P1">
    <measure number="1">
      <attributes>
        <divisions>4</divisions>
        <key><fifths>0</fifths></key>
        <time><beats>4</beats><beat-type>4</beat-type></time>
        <clef><sign>G</sign><line>2</line></clef>
      </attributes>
      <note>
        <pitch><step>C</step><octave>4</octave></pitch>
        <duration>4</duration>
        <voice>1</voice>
      </note>
      <note>
        <pitch><step>D</step><octave>4</octave></pitch>
        <duration>4</duration>
        <voice>1</voice>
      </note>
    </measure>
    <measure number="2">
      <note>
        <pitch><step>E</step><octave>4</octave></pitch>
        <duration>4</duration>
        <voice>1</voice>
      </note>
    </measure>
  </part>
</score-partwise>`;

            vrvToolkit.loadData(testXML);
            const svg = vrvToolkit.renderToSVG(1);
            document.getElementById('output').innerHTML = svg;
            
            // Analyze SVG structure
            console.log('SVG Structure Analysis:');
            const svgElement = document.querySelector('svg');
            if (svgElement) {
                const notes = svgElement.querySelectorAll('.note, [class*="note"]');
                console.log('Found notes:', notes.length);
                
                notes.forEach((note, index) => {
                    console.log(`Note ${index}:`);
                    console.log('  ID:', note.getAttribute('id'));
                    console.log('  Class:', note.getAttribute('class'));
                    console.log('  Parent elements:');
                    
                    let parent = note.parentElement;
                    let level = 0;
                    while (parent && parent.tagName !== 'svg' && level < 10) {
                        console.log(`    Level ${level}: ${parent.tagName}, id="${parent.getAttribute('id')}", class="${parent.getAttribute('class')}"`);
                        parent = parent.parentElement;
                        level++;
                    }
                    console.log('---');
                });
            }
        };
    </script>
</body>
</html>
